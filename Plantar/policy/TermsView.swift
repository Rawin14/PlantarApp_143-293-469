//
//  PrivacyPolicyView.swift
//  Plantar
//
//  Created by Jeerapan Chirachanchai on 7/10/2568 BE.
//

import SwiftUI

struct TermsView: View {
    @State private var agreed = false
    //    @State private var goNext = false
    
    @AppStorage("isFirstLaunch") var isFirstLaunch: Bool = true
    
    var body: some View {
        VStack(alignment: .leading, spacing: 20) {
            Text("ข้อจำกัดการใช้งาน")
                .font(.title)
                .fontWeight(.bold)
            
            ScrollView {
                Text("""
                ข้อกำหนดการใช้งานและนโยบายความเป็นส่วนตัว
                
                แอปพลิเคชันนี้ให้ความสำคัญกับการคุ้มครองข้อมูลส่วนบุคคลและข้อมูลด้านสุขภาพของผู้ใช้งานเป็นอย่างยิ่ง เอกสารฉบับนี้จัดทำขึ้นเพื่อชี้แจงถึงการเก็บรวบรวม การใช้ การจัดเก็บ และการคุ้มครองข้อมูล ก่อนที่ผู้ใช้งานจะเริ่มใช้งานแอปพลิเคชัน กรุณาอ่านและทำความเข้าใจข้อกำหนดนี้อย่างละเอียด
                
                1. ประเภทของข้อมูลที่เก็บรวบรวม  
                แอปพลิเคชันอาจมีการเก็บรวบรวมข้อมูลดังต่อไปนี้  
                - ข้อมูลส่วนบุคคลทั่วไป ได้แก่ อายุ และเพศ  
                - ข้อมูลด้านร่างกายและสุขภาพ ได้แก่ น้ำหนัก ส่วนสูง และข้อมูลที่ใช้ในการคำนวณค่า BMI  
                - ข้อมูลภาพถ่าย ได้แก่ ภาพถ่ายฝ่าเท้าที่ได้จากการถ่ายภาพผ่านกล้องของอุปกรณ์  
                - ข้อมูลการใช้งานที่เกี่ยวข้องกับการประเมินและการแสดงผลภายในแอปพลิเคชัน  
                
                2. วัตถุประสงค์ในการเก็บรวบรวมและใช้ข้อมูล  
                ข้อมูลที่เก็บรวบรวมจะถูกนำไปใช้เพื่อวัตถุประสงค์ดังต่อไปนี้  
                - เพื่อการประเมินสภาพฝ่าเท้าและสุขภาพในระดับเบื้องต้นเท่านั้น  
                - เพื่อคำนวณ วิเคราะห์ และแสดงผลข้อมูลด้านสุขภาพ  
                - เพื่อแนะนำแนวทางการดูแลสุขภาพหรือการออกกำลังกายที่เหมาะสมกับผู้ใช้งาน  
                - เพื่อปรับปรุงประสิทธิภาพและประสบการณ์การใช้งานของแอปพลิเคชัน  
                
                3. ข้อจำกัดและการประเมินเบื้องต้น 
                แอปพลิเคชันนี้จัดทำขึ้นเพื่อการประเมินข้อมูลด้านสุขภาพในเบื้องต้นเท่านั้น ข้อมูล ผลลัพธ์ และคำแนะนำที่แสดงในแอป ไม่ถือเป็นการวินิจฉัย การรักษา หรือคำแนะนำทางการแพทย์ และไม่สามารถใช้ทดแทนการตรวจหรือคำปรึกษาจากแพทย์หรือผู้เชี่ยวชาญทางการแพทย์ได้ หากผู้ใช้งานมีอาการผิดปกติหรือข้อสงสัยด้านสุขภาพ ควรปรึกษาแพทย์โดยตรง
                
                4. การใช้กล้องและข้อมูลภาพถ่าย  
                แอปพลิเคชันจะขออนุญาตเข้าถึงกล้องของอุปกรณ์เฉพาะในกรณีที่จำเป็น เพื่อใช้ในการถ่ายภาพฝ่าเท้าสำหรับการประเมินเท่านั้น ภาพถ่ายดังกล่าวจะถูกใช้ตามวัตถุประสงค์ที่ระบุไว้ และจะไม่ถูกนำไปใช้เพื่อวัตถุประสงค์อื่นโดยไม่ได้รับความยินยอมจากผู้ใช้งาน
                
                5. ฐานทางกฎหมายในการประมวลผลข้อมูล  
                การเก็บรวบรวมและประมวลผลข้อมูลส่วนบุคคลและข้อมูลด้านสุขภาพ ดำเนินการบนพื้นฐานของความยินยอมจากผู้ใช้งาน ผู้ใช้งานสามารถถอนความยินยอมได้ตลอดเวลา ทั้งนี้ การถอนความยินยอมอาจส่งผลต่อการใช้งานบางฟังก์ชันของแอปพลิเคชัน
                
                6. การจัดเก็บและการคุ้มครองข้อมูล
                ข้อมูลของผู้ใช้งานจะถูกจัดเก็บด้วยมาตรการรักษาความปลอดภัยที่เหมาะสม เพื่อป้องกันการเข้าถึง การเปิดเผย หรือการใช้งานข้อมูลโดยไม่ได้รับอนุญาต และจะถูกจัดเก็บเฉพาะเท่าที่จำเป็นต่อการให้บริการของแอปพลิเคชัน
                
                7. ระยะเวลาในการเก็บรักษาข้อมูล
                ข้อมูลส่วนบุคคลและข้อมูลด้านสุขภาพจะถูกจัดเก็บตลอดระยะเวลาที่ผู้ใช้งานยังคงใช้งานแอปพลิเคชัน หรือจนกว่าผู้ใช้งานจะร้องขอให้ลบข้อมูลหรือยุติการใช้งาน
                
                8. การเปิดเผยข้อมูลแก่บุคคลภายนอก
                แอปพลิเคชันจะไม่เปิดเผยข้อมูลของผู้ใช้งานให้แก่บุคคลภายนอก เว้นแต่จะได้รับความยินยอมจากผู้ใช้งาน หรือเป็นไปตามข้อกำหนดของกฎหมาย
                
                9. การยอมรับข้อกำหนด 
                เมื่อผู้ใช้งานกด “ยอมรับข้อกำหนดการใช้งาน” และเริ่มใช้งานแอปพลิเคชัน ถือว่าผู้ใช้งานได้อ่าน ทำความเข้าใจ และยินยอมให้แอปพลิเคชันเก็บรวบรวม ใช้ และจัดเก็บข้อมูลตามข้อกำหนดที่ระบุไว้ทั้งหมด
                
                ข้อตกลงและนโยบายการใช้งานแอป Plantar
                                                
                1. แอป Plantar พัฒนาเพื่อช่วยบรรเทาอาการรองช้ำเบื้องต้น ให้คำแนะนำด้านกายภาพที่เหมาะสม และช่วยลดค่าใช้จ่ายในการรักษา
                2. แอปให้ข้อมูลเพื่อการดูแลตนเองหากเจ็บฝ่าเท้าเบื้องต้นเท่านั้น ไม่ใช่การวินิจฉัย หรือ การรักษาทางการแพทย์
                3. คำแนะนำในแอปไม่สามารถใช้แทนคำแนะนำจากแพทย์ หรือ ผู้เชี่ยวชาญได้
                4. ผู้พัฒนาไม่รับผิดชอบต่อผลกระทบที่อาจเกิดขึ้นจากการใช้งานแอป
                5. แอปมีวัตถุประสงค์เพื่อลดค่าใช้จ่ายในการดูแลรักษาเบื้องต้นเท่านั้น
                6. แอปอาจเก็บข้อมูลการใช้งานและความพึงพอใจเพื่อพัฒนาแอป
                7. ผู้พัฒนาขอสงวนสิทธิ์ในการเปลี่ยนแปลงนโยบายโดยไม่ต้องแจ้งล่วงหน้า
                """)
                
                
            }
            .padding()
            .background(Color.white)
            .cornerRadius(30)
            .shadow(radius: 3)
            .padding(.horizontal)
            
            Spacer()
            Button(action: {
                agreed.toggle()
            }) {
                HStack {
                    Image(systemName: agreed ? "checkmark.circle.fill" : "circle")
                        .foregroundColor(agreed ? .black : .gray)
                    Text("ฉันยอมรับข้อกำหนดการใช้งาน")
                        .font(.subheadline)
                        .fontWeight(.semibold)
                        .foregroundColor(.black)
                }
            }
            
            Button(action: {
                if agreed {
                    // ✅ เมื่อกดยอมรับ ให้บันทึกว่าไม่ใช่ครั้งแรกอีกต่อไป
                    // PlantarApp จะตรวจพบค่านี้ที่เปลี่ยนไป และสลับไปหน้า LoginView ทันที
                    withAnimation {
                        isFirstLaunch = false
                    }
                }
            }) {
                Text("Next")
                    .font(.system(size: 18, weight: .semibold))
                    .foregroundColor(.white)
                    .frame(maxWidth: .infinity)
                    .padding()
                    .background(agreed ? Color.black : Color.gray)
                    .cornerRadius(20)
                    .shadow(radius: 4)
            }
            .disabled(!agreed)
            
            Spacer()
        }
        .padding()
        .background(Color(red: 1.0, green: 0.99, blue: 0.9))
        .transition(.opacity)
    }
}


#Preview {
    TermsView()
}
